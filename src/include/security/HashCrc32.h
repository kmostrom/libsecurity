/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#pragma once

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#include <string>

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#define CRC32_SFV_POLY		0xEDB88320
#define CRC32_REVERSE_POLY	0xEDB88320

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

class HashCrc32
{
public:
	static std::string GetCrc32(char* buffer, unsigned int size);
	static std::string GetCrc32(const char* fileName);

	unsigned int GetCrc32Polynomial(void);

protected:

	HashCrc32(unsigned int polynomial = CRC32_REVERSE_POLY); // Default polynomial for use when calculating SFV checksums
	virtual ~HashCrc32() {};

	unsigned int BuildCrc32Table(unsigned int polynomial);

	unsigned int Update(const char* buffer, unsigned int length);
	std::string Finalize();

	unsigned int mCrc32Table[256];
	unsigned int mPolynomial;
	unsigned int mCrc32;
};

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
